Реализует закрытые ресурсы на MODx. Создание подписки на ресурс, выбор подписки и оплата платной подписки
со счета [msProfile][2] пользователем самостоятельно, а так же подписка пользователей в админке сайта.

[![](https://file.modx.pro/files/f/0/5/f0549dad333e25dd6a276088934afe90s.jpg)](https://file.modx.pro/files/f/0/5/f0549dad333e25dd6a276088934afe90.png)

#### Подключение вкладки с подпиской
В системных настройках выбрать **payandsee_enable_for_templates**.
В ней можно перечислить id шаблонов через запятую, для которых будет активирована вкладка с подпиской.

#### Создание подписки
На странице ресурса появится новая вкладка Закрытый контент — тут можно создать и настроить подписку к ресурсу(ам).

#### Параметры подписки и настройки доступа
— заголовок подписки
— описание подписки
— цена подписки
— цена продления подписки
— период подписки
— идентификатор подписки
— показывать авторизованным
— показывать подписанным
— временно открыта
— выключена
— активна для потомков

Можно выставить настройку показывать **авторизованным** и контент будет доступен только авторизованным пользователям,
ну а если стоит настройка **подписанным** то пользователь увидит подписку только при наличии у него активной подписки.

#### Страница **доступ запрещен**
Если у пользователя нет доступа то он увидит страницу доступ запрещен, **id** страницы нужно проставить в настройках пакета.
##### На этой странице доступно два плейсходера:
— original_id — **id оригинальной** страницы 
— subscribed_id — **id подписки**

#### Вывод подписок
В комплекте сниппет для вывода подписок — **[psSubscription]**.
C его помощью можно вывести необходымые подписки.

[![](https://file.modx.pro/files/e/b/e/ebe1c4a562234108a9e74af7014fd933s.jpg)](https://file.modx.pro/files/e/b/e/ebe1c4a562234108a9e74af7014fd933.png)

#### Вывод подписок к оплате
В комплекте сниппет для вывода подписок пользователя — **[psList]**.
C его помощью можно вывести подписки выбранные пользователем, но еще не оплаченные.

[![](https://file.modx.pro/files/a/f/4/af42f5bae291ac3a84810972c425a8dbs.jpg)](https://file.modx.pro/files/a/f/4/af42f5bae291ac3a84810972c425a8db.png)

Тут можно удалить подписку, изменить кол-во, вообщем и целом это список подписок к оплате.

#### Оплата подписок
В комплекте сниппет для оплаты подписок — **[psBuy]**.
C его помощью можно вывести профиль покупателя и совершить покупку.

[![](https://file.modx.pro/files/a/1/9/a196b2ae0c97ea0620258f48c293683es.jpg)](https://file.modx.pro/files/a/1/9/a196b2ae0c97ea0620258f48c293683e.png)

#### Уведомления при покупке
В настройках [Minishop2][1] необходимо создать отдельный стутус для покупки подписок.
Соответственно весь механизм уведомления при покупке родной от [Minishop2][1]. Средства с личного счета 
[msProfile][2] списываются при покупке и отображаются в родном табе [msProfile][2].

#### Подписка пользователя в админке
Выбираете пользователя, выбираете нужное кол-во дней.
Подписка в админке немного отличается от подписки пользователем самостоятельно.
Во первых при подписке можно указать любое кол-во дней, независимо от срока указанного в параметрах подписки,
а так же средства со счета пользователя не снимаются. То есть пользователь получает доступ к ресурсам минуя покупку.

[![](https://file.modx.pro/files/e/e/3/ee3e985fb4a09647e4591ce45cfef795s.jpg)](https://file.modx.pro/files/e/e/3/ee3e985fb4a09647e4591ce45cfef795.png)

#### Окончание срока подписки
Для перевода просроченных подписок в неактивное состояние в комплекте скрипт для cron.
При запуске выбирает просроченные подписки и ставит статус — неактивна.
Так же одновременно формирует список писем пользователям и указанным менеджерам об окончании подписки.
Для рассылки писем из очереди тоже имеется скрипт для cron.

#### Внимание!!!
Для работы пакета необходимо наличие установленных пакетов [Minishop2][1] и [msProfile][2]

[1]: /ru/01_Компоненты/02_miniShop2/
[2]: /ru/01_Компоненты/02_miniShop2/05_Другие_дополнения/05_msProfile/
